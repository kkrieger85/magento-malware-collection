#!/usr/bin/env bash
# Magento Malware Scanner
# Downloads and extracts a Magento version to test for false flags against the vanilla code

if [ ! -z ${MAGENTO_VERSION+x} ]; then

    target_directory="${SETUP_DIR:-./}${MAGENTO_VERSION}"

    echo "downloading magento ${MAGENTO_VERSION}"

    curl -LOk  "https://github.com/OpenMage/magento-mirror/archive/${MAGENTO_VERSION}.zip"

    if [ 0 -eq $?  ]; then

    echo "unzipping magento ${MAGENTO_VERSION}"

    unzip -qq "${MAGENTO_VERSION}.zip" -d ${target_directory}

    else
        echo -e "Download failed! $MAGENTO_VERSION"

        # not sure if i should let it fail or skip the test
    fi;

fi
